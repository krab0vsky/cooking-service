<!-- views/notification_settings.hbs -->
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h4 class="mb-0"><i class="bi bi-gear"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</h4>
                </div>
                
                <div class="card-body">
                    <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
                    <div class="mb-4">
                        <h5><i class="bi bi-envelope"></i> Email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h5>
                        <p class="text-muted">–ü–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–∞ email</p>
                        
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" 
                                   id="emailNotifications" 
                                   {{#if emailNotifications}}checked{{/if}}
                                   style="transform: scale(1.3);">
                            <label class="form-check-label ms-2" for="emailNotifications">
                                –í–∫–ª—é—á–∏—Ç—å email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                            </label>
                        </div>
                        
                        <div class="alert alert-info mt-3">
                            <i class="bi bi-info-circle"></i>
                            –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –±—É–¥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –Ω–∞: <strong>{{user.email}}</strong>
                        </div>
                    </div>
                </div>
                
                <div class="card-footer">
                    <a href="/recipes" class="btn btn-primary">
                        <i class="bi bi-house"></i> –ù–∞ –≥–ª–∞–≤–Ω—É—é
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const emailSwitch = document.getElementById('emailNotifications');
    
    emailSwitch.addEventListener('change', async function() {
        try {
            const response = await fetch('/profile/notifications/email', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    enable: this.checked ? '1' : '0'
                })
            });
            
            const data = await response.json();
            
            if (data.success) {
                if (this.checked) {
                    alert('‚úÖ Email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã');
                } else {
                    alert('üîï Email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–∫–ª—é—á–µ–Ω—ã');
                }
            } else {
                this.checked = !this.checked;
                alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫');
            }
        } catch (err) {
            console.error('–û—à–∏–±–∫–∞:', err);
            this.checked = !this.checked;
            alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫');
        }
    });
});
</script>